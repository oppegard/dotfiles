#!/usr/bin/env bash
set -euo pipefail

# Wrapper name: try
# Expects sibling binaries like: try-darwin-aarch64, try-linux-x86_64, etc.

os="$(uname -s | tr '[:upper:]' '[:lower:]')"
arch="$(uname -m)"

case "$os" in
  darwin|linux) ;;
  *) echo "unsupported OS: $os" >&2; exit 1 ;;
esac

case "$arch" in
  arm64|aarch64) arch="aarch64" ;;
  x86_64|amd64)  arch="x86_64" ;;
  *) echo "unsupported arch: $arch" >&2; exit 1 ;;
esac

self_dir="$(CDPATH= cd -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd)"
bin="${self_dir}/try-${os}-${arch}"

exec "$bin" "$@"
